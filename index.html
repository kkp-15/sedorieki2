<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>利益計算</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 20px;
        }
        input, button {
            margin: 10px;
            padding: 8px;
            font-size: 16px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }
        th {
            background-color: #f4f4f4;
        }
    </style>
</head>
<body>
    <h1>利益計算ツール</h1>
    
    <label for="date">仕入れ年月日:</label>
    <input type="date" id="date"><br>

    <label for="purchase">仕入れ価格:</label>
    <input type="number" id="purchase" placeholder="円"><br>

    <label for="sell">販売価格:</label>
    <input type="number" id="sell" placeholder="円"><br>

    <label for="shipping">送料・梱包費:</label>
    <input type="number" id="shipping" placeholder="円"><br>

    <label for="feePercent">手数料(%):</label>
    <input type="number" id="feePercent" placeholder="%" step="0.1"><br>

    <label for="memo">メモ:</label>
    <input type="text" id="memo" placeholder="備考"><br>

    <button onclick="calculateProfit()">利益計算</button>
    <button onclick="saveEntry()">保存</button>
    <button onclick="goToHistory()">履歴を見る</button>

    <h2>計算結果</h2>
    <table>
        <tr>
            <th>利益</th>
            <td id="profitResult">-</td>
        </tr>
    </table>

    <script>
        function calculateProfit() {
            let purchase = parseFloat(document.getElementById('purchase').value) || 0;
            let sell = parseFloat(document.getElementById('sell').value) || 0;
            let shipping = parseFloat(document.getElementById('shipping').value) || 0;
            let feePercent = parseFloat(document.getElementById('feePercent').value) || 0;

            let profit = (sell - purchase - shipping - (sell * (feePercent / 100))).toFixed(2);
            document.getElementById('profitResult').textContent = profit + " 円";
        }

        function saveEntry() {
            let date = document.getElementById('date').value;
            let purchase = parseFloat(document.getElementById('purchase').value) || 0;
            let sell = parseFloat(document.getElementById('sell').value) || 0;
            let shipping = parseFloat(document.getElementById('shipping').value) || 0;
            let feePercent = parseFloat(document.getElementById('feePercent').value) || 0;
            let memo = document.getElementById('memo').value;

            if (!date) {
                alert("仕入れ年月日を入力してください");
                return;
            }

            let history = JSON.parse(localStorage.getItem('history')) || [];
            history.push({ date, purchase, sell, shipping, feePercent, memo });
            localStorage.setItem('history', JSON.stringify(history));

            alert("データを保存しました");
            clearInputs();
        }

        function clearInputs() {
            document.getElementById('date').value = "";
            document.getElementById('purchase').value = "";
            document.getElementById('sell').value = "";
            document.getElementById('shipping').value = "";
            document.getElementById('feePercent').value = "";
            document.getElementById('memo').value = "";
            document.getElementById('profitResult').textContent = "-";
        }

        function goToHistory() {
            window.location.href = 'history.html';
        }
    </script>
</body>
</html>
